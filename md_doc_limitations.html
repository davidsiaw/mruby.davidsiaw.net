<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mruby: Limitations and Differences</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mruby_logo_red_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mruby
   &#160;<span id="projectnumber">2.0.1</span>
   </div>
   <div id="projectbrief">mruby is the lightweight implementation of the Ruby language</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Limitations and Differences </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The philosophy of mruby is to be a lightweight implementation of the Ruby ISO standard. These two objectives are partially contradicting. Ruby is an expressive language with complex implementation details which are difficult to implement in a lightweight manner. To cope with this, limitations to the "Ruby Compatibility" are defined.</p>
<p>This document is collecting these limitations.</p>
<h2>Integrity</h2>
<p>This document does not contain a complete list of limitations. Please help to improve it by submitting your findings.</p>
<h2><code>1/2</code> gives <code>0.5</code></h2>
<p>Since mruby does not have <code>Bignum</code>, bigger integers are represented by <code>Float</code> numbers. To enhance interoperability between <code>Fixnum</code> and <code>Float</code>, mruby provides <code>Float::upto</code> and other iterating methods for the <code>Float</code> class. As a side effect, <code>1/2</code> gives <code>0.5</code> not <code>0</code>.</p>
<h2><code>Array</code> passed to <code>puts</code></h2>
<p>Passing an Array to <code>puts</code> results in different output.</p>
<div class="fragment"><div class="line">puts [1,2,3]</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<div class="fragment"><div class="line">1</div><div class="line">2</div><div class="line">3</div></div><!-- fragment --><h4>mruby [2.0.1 (2019-4-4)]</h4>
<div class="fragment"><div class="line">[1, 2, 3]</div></div><!-- fragment --><h2><code>Kernel.raise</code> in rescue clause</h2>
<p><code>Kernel.raise</code> without arguments does not raise the current exception within a rescue clause.</p>
<div class="fragment"><div class="line">begin</div><div class="line">  1 / 0</div><div class="line">rescue</div><div class="line">  raise</div><div class="line">end</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<p><code>ZeroDivisionError</code> is raised.</p>
<h4>mruby [2.0.1 (2019-4-4)]</h4>
<p>No exception is raised.</p>
<h2>Fiber execution can't cross C function boundary</h2>
<p>mruby's <code>Fiber</code> is implemented in a similar way to Lua's co-routine. This results in the consequence that you can't switch context within C functions. Only exception is <code>mrb_fiber_yield</code> at return.</p>
<h2><code>Array</code> does not support instance variables</h2>
<p>To reduce memory consumption <code>Array</code> does not support instance variables.</p>
<div class="fragment"><div class="line">class Liste &lt; Array</div><div class="line">  def initialize(str = nil)</div><div class="line">    @feld = str</div><div class="line">  end</div><div class="line">end</div><div class="line"></div><div class="line">p Liste.new &quot;foobar&quot;</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<p><code>[]</code></p>
<h4>mruby [2.0.1 (2019-4-4)]</h4>
<p><code>ArgumentError</code> is raised.</p>
<h2>Method visibility</h2>
<p>For simplicity reasons no method visibility (public/private/protected) is supported.</p>
<div class="fragment"><div class="line">class VisibleTest</div><div class="line"></div><div class="line">  def public_method; end</div><div class="line"></div><div class="line">  private</div><div class="line">  def private_method; end</div><div class="line"></div><div class="line">end</div><div class="line"></div><div class="line">p VisibleTest.new.respond_to?(:private_method, false)</div><div class="line">p VisibleTest.new.respond_to?(:private_method, true)</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<div class="fragment"><div class="line">false</div><div class="line">true</div></div><!-- fragment --><h4>mruby [2.0.1 (2019-4-4)]</h4>
<div class="fragment"><div class="line">true</div><div class="line">true</div></div><!-- fragment --><h2>defined?</h2>
<p>The <code>defined?</code> keyword is considered too complex to be fully implemented. It is recommended to use <code>const_defined?</code> and other reflection methods instead.</p>
<div class="fragment"><div class="line">defined?(Foo)</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<div class="fragment"><div class="line">nil</div></div><!-- fragment --><h4>mruby [2.0.1 (2019-4-4)]</h4>
<p><code>NameError</code> is raised.</p>
<h2><code>alias</code> on global variables</h2>
<p>Aliasing a global variable works in CRuby but is not part of the ISO standard.</p>
<div class="fragment"><div class="line">alias $a $__a__</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<p><code>nil</code></p>
<h4>mruby [2.0.1 (2019-4-4)]</h4>
<p>Syntax error</p>
<h2>Operator modification</h2>
<p>An operator can't be overwritten by the user.</p>
<div class="fragment"><div class="line">class String</div><div class="line">  def +</div><div class="line">  end</div><div class="line">end</div><div class="line"></div><div class="line">&#39;a&#39; + &#39;b&#39;</div></div><!-- fragment --><h4>Ruby [ruby 2.0.0p645 (2015-04-13 revision 50299)]</h4>
<p><code>ArgumentError</code> is raised. The re-defined <code>+</code> operator does not accept any arguments.</p>
<h4>mruby [2.0.1 (2019-4-4)]</h4>
<p><code>'ab'</code> Behavior of the operator wasn't changed.</p>
<h2>Kernel::binding is not supported</h2>
<p><code>Kernel::binding</code> method is not supported.</p>
<h4>Ruby [ruby 2.5.1p57 (2018-03-29 revision 63029)]</h4>
<div class="fragment"><div class="line">$ ruby -e &#39;puts Proc.new {}.binding&#39;</div><div class="line">#&lt;Binding:0x00000e9deabb9950&gt;</div></div><!-- fragment --><h4>mruby [2.0.1 (2019-4-4)]</h4>
<div class="fragment"><div class="line">$ ./bin/mruby -e &#39;puts Proc.new {}.binding&#39;</div><div class="line">trace (most recent call last):</div><div class="line">        [0] -e:1</div><div class="line">-e:1: undefined method &#39;binding&#39; (NoMethodError)</div></div><!-- fragment --><h2>Keyword arguments</h2>
<p>mruby keyword arguments behave slightly different from CRuby 2.5 to make the behavior simpler and less confusing. Maybe in the future, the simpler behavior will be adopted to CRuby as well.</p>
<h4>Ruby [ruby 2.5.1p57 (2018-03-29 revision 63029)]</h4>
<div class="fragment"><div class="line">$ ruby -e &#39;def m(*r,**k) p [r,k] end; m(&quot;a&quot;=&gt;1,:b=&gt;2)&#39;</div><div class="line">[[{&quot;a&quot;=&gt;1}], {:b=&gt;2}]</div></div><!-- fragment --><h4>mruby [mruby 2.0.1]</h4>
<div class="fragment"><div class="line">$ ./bin/mruby -e &#39;def m(*r,**k) p [r,k] end; m(&quot;a&quot;=&gt;1,:b=&gt;2)&#39;</div><div class="line">trace (most recent call last):</div><div class="line">    [0] -e:1</div><div class="line">-e:1: keyword argument hash with non symbol keys (ArgumentError)</div></div><!-- fragment --><h2><a class="el" href="classArgument.html">Argument</a> Destructuring</h2>
<div class="fragment"><div class="line">def m(a,(b,c),d); p [a,b,c,d]; end</div><div class="line">m(1,[2,3],4)  # =&gt; [1,2,3,4]</div></div><!-- fragment --><p> Destructured arguments (<code>b</code> and <code>c</code> in above example) cannot be accessed from the default expression of optional arguments and keyword arguments, since actual assignment is done after the evaluation of those default expressions. Thus:</p>
<div class="fragment"><div class="line">def f(a,(b,c),d=b)</div><div class="line">  p [a,b,c,d]</div><div class="line">end</div><div class="line">f(1,[2,3])</div></div><!-- fragment --><p>CRuby gives <code>[1,2,3,nil]</code>. mruby raises <code>NoMethodError</code> for <code>b</code>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
