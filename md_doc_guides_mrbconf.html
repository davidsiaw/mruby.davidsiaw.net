<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mruby: mruby configuration macros.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mruby_logo_red_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mruby
   &#160;<span id="projectnumber">2.0.1</span>
   </div>
   <div id="projectbrief">mruby is the lightweight implementation of the Ruby language</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mruby configuration macros. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>How to use these macros.</h2>
<p>You can use mrbconfs with following ways:</p><ul>
<li>Write them in <code><a class="el" href="mrbconf_8h_source.html">mrbconf.h</a></code>.<ul>
<li>Using compiler flags is preferred when building a cross binaries or multiple mruby binaries since it's easier to use different mrbconf per each <code>MRuby::Build</code>.</li>
<li>Most flags can be enabled by just commenting in.</li>
</ul>
</li>
<li>Pass them as compiler flags.<ul>
<li>Make sure you pass the same flags to all compilers since some mrbconf(e.g., <code>MRB_GC_FIXED_ARENA</code>) changes <code>struct</code> layout and cause memory access error when C and other language(e.g., C++) is mixed.</li>
</ul>
</li>
</ul>
<h2>stdio setting.</h2>
<p><code>MRB_DISABLE_STDIO</code></p><ul>
<li>When defined <code>&lt;stdio.h&gt;</code> functions won't be used.</li>
<li>Some features will be disabled when this is enabled:<ul>
<li><code><a class="el" href="structmrb__irep.html">mrb_irep</a></code> load/dump from/to file.</li>
<li>Compiling mruby script from file.</li>
<li>Printing features in <b>src/print.c</b>.</li>
</ul>
</li>
</ul>
<h2>Debug macros.</h2>
<p><code>MRB_ENABLE_DEBUG_HOOK</code></p><ul>
<li>When defined code fetch hook and debug OP hook will be enabled.</li>
<li>When using any of the hook set function pointer <code>code_fetch_hook</code> and/or <code>debug_op_hook</code> of <code><a class="el" href="structmrb__state.html">mrb_state</a></code>.</li>
<li>Fetch hook will be called before any OP.</li>
<li>Debug OP hook will be called when dispatching <code>OP_DEBUG</code>.</li>
</ul>
<p><code>MRB_DEBUG</code></p><ul>
<li>When defined <code>mrb_assert*</code> macro will be defined with macros from <code>&lt;assert.h&gt;</code>.</li>
<li>Could be enabled via <code>enable_debug</code> method of <code>MRuby::Build</code>.</li>
</ul>
<h2>Stack configuration</h2>
<p><code>MRB_STACK_EXTEND_DOUBLING</code></p><ul>
<li>If defined doubles the stack size when extending it.</li>
<li>Else extends stack with <code>MRB_STACK_GROWTH</code>.</li>
</ul>
<p><code>MRB_STACK_GROWTH</code></p><ul>
<li>Default value is <code>128</code>.</li>
<li>Used in stack extending.</li>
<li>Ignored when <code>MRB_STACK_EXTEND_DOUBLING</code> is defined.</li>
</ul>
<p><code>MRB_STACK_MAX</code></p><ul>
<li>Default value is <code>0x40000 - MRB_STACK_GROWTH</code>.</li>
<li>Raises <code>RuntimeError</code> when stack size exceeds this value.</li>
</ul>
<h2>Primitive type configuration.</h2>
<p><code>MRB_USE_FLOAT</code></p><ul>
<li>When defined single precision floating point type(C type <code>float</code>) is used as <code>mrb_float</code>.</li>
<li>Else double precision floating point type(C type <code>double</code>) is used as <code>mrb_float</code>.</li>
</ul>
<p><code>MRB_WITHOUT_FLOAT</code></p><ul>
<li>When defined removes floating point numbers from mruby.</li>
<li>It makes mruby easier to handle in "Microcontroller without FPU" and "Kernel Space".</li>
</ul>
<p><code>MRB_INT16</code></p><ul>
<li>When defined <code>int16_t</code> will be defined as <code>mrb_int</code>.</li>
<li>Conflicts with <code>MRB_INT32</code> and <code>MRB_INT64</code>.</li>
</ul>
<p><code>MRB_INT32</code></p><ul>
<li>When defined, or both <code>MRB_INT16</code> and <code>MRB_INT64</code> are not defined on 32-bit CPU mode, <code>int32_t</code> will be defined as <code>mrb_int</code>.</li>
<li>Conflicts with <code>MRB_INT16</code> and <code>MRB_INT64</code>.</li>
</ul>
<p><code>MRB_INT64</code></p><ul>
<li>When defined, or both <code>MRB_INT16</code> and <code>MRB_INT32</code> are not defined on 64-bit CPU mode, <code>int64_t</code> will be defined as <code>mrb_int</code>.</li>
<li>Conflicts with <code>MRB_INT16</code> and <code>MRB_INT32</code>.</li>
</ul>
<h2>Garbage collector configuration.</h2>
<p><code>MRB_GC_STRESS</code></p><ul>
<li>When defined full GC is emitted per each <code><a class="el" href="structRBasic.html">RBasic</a></code> allocation.</li>
<li>Mainly used in memory manager debugging.</li>
</ul>
<p><code>MRB_GC_TURN_OFF_GENERATIONAL</code></p><ul>
<li>When defined turns generational GC by default.</li>
</ul>
<p><code>MRB_GC_FIXED_ARENA</code></p><ul>
<li>When defined used fixed size GC arena.</li>
<li>Raises <code>RuntimeError</code> when this is defined and GC arena size exceeds <code>MRB_GC_ARENA_SIZE</code>.</li>
<li>Useful tracking unnecessary mruby object allocation.</li>
</ul>
<p><code>MRB_GC_ARENA_SIZE</code></p><ul>
<li>Default value is <code>100</code>.</li>
<li>Ignored when <code>MRB_GC_FIXED_ARENA</code> isn't defined.</li>
<li>Defines fixed GC arena size.</li>
</ul>
<p><code>MRB_HEAP_PAGE_SIZE</code></p><ul>
<li>Defines value is <code>1024</code>.</li>
<li>Specifies number of <code><a class="el" href="structRBasic.html">RBasic</a></code> per each heap page.</li>
</ul>
<h2>Memory pool configuration.</h2>
<p><code>POOL_ALIGNMENT</code></p><ul>
<li>Default value is <code>4</code>.</li>
<li>If you're allocating data types that requires alignment more than default value define the largest value of required alignment.</li>
</ul>
<p><code>POOL_PAGE_SIZE</code></p><ul>
<li>Default value is <code>16000</code>.</li>
<li>Specifies page size of pool page.</li>
<li>Smaller the value is increases memory overhead.</li>
</ul>
<h2>State atexit configuration.</h2>
<p><code>MRB_FIXED_STATE_ATEXIT_STACK</code></p><ul>
<li>If defined enables fixed size <code><a class="el" href="structmrb__state.html">mrb_state</a></code> atexit stack.</li>
<li>Raises <code>RuntimeError</code> when <code>mrb_state_atexit</code> call count to same <code><a class="el" href="structmrb__state.html">mrb_state</a></code> exceeds <code>MRB_FIXED_STATE_ATEXIT_STACK_SIZE</code>'s value.</li>
</ul>
<p><code>MRB_FIXED_STATE_ATEXIT_STACK_SIZE</code></p><ul>
<li>Default value is <code>5</code>.</li>
<li>If <code>MRB_FIXED_STATE_ATEXIT_STACK</code> isn't defined this macro is ignored.</li>
</ul>
<h2><code><a class="el" href="structmrb__value.html">mrb_value</a></code> configuration.</h2>
<p><code>MRB_ENDIAN_BIG</code></p><ul>
<li>If defined compiles mruby for big endian machines.</li>
<li>Used in <code>MRB_NAN_BOXING</code>.</li>
<li>Some mrbgem use this mrbconf.</li>
</ul>
<p><code>MRB_NAN_BOXING</code></p><ul>
<li>If defined represent <code><a class="el" href="structmrb__value.html">mrb_value</a></code> in boxed <code>double</code>.</li>
<li>Conflicts with <code>MRB_USE_FLOAT</code> and <code>MRB_WITHOUT_FLOAT</code>.</li>
</ul>
<p><code>MRB_WORD_BOXING</code></p><ul>
<li>If defined represent <code><a class="el" href="structmrb__value.html">mrb_value</a></code> as a word.</li>
<li>If defined <code>Float</code> will be a mruby object with <code><a class="el" href="structRBasic.html">RBasic</a></code>.</li>
</ul>
<h2>Instance variable configuration.</h2>
<p><code>MRB_IV_SEGMENT_SIZE</code></p><ul>
<li>Default value is <code>4</code>.</li>
<li>Specifies size of each segment in segment list.</li>
</ul>
<h2>Reduce heap memory configuration.</h2>
<p><code>MRB_USE_ETEXT_EDATA</code></p><ul>
<li>If you specify the address of a read-only section when creating a symbol or string, that string will be used as it is.</li>
<li>Heap memory can be saved.</li>
<li>Uses <code>_etext</code> and <code>__init_array_start</code>.</li>
<li>It must be <code>_etext &lt; data_addr &lt; &amp;__init_array_start</code>.</li>
</ul>
<p><code>MRB_NO_INIT_ARRAY_START</code></p><ul>
<li>Ignored if <code>MRB_USE_ETEXT_EDATA</code> is not defined.</li>
<li>Please try if <code>__init_array_start</code> is not available.</li>
<li>Uses <code>_etext</code> and <code>_edata</code>.</li>
<li>It must be <code>_etext &lt; data_addr &lt; _edata</code>.</li>
</ul>
<p><code>MRB_USE_CUSTOM_RO_DATA_P</code></p><ul>
<li>Takes precedence over <code>MRB_USE_ETEXT_EDATA</code>.</li>
<li>Please try if both <code>MRB_USE_ETEXT_EDATA</code> and <code>MRB_NO_INIT_ARRAY_START</code> are not available.</li>
<li>The <code>mrb_ro_data_p()</code> function is implemented by the user in an arbitrary file.</li>
<li>The prototype declaration is <code><a class="el" href="classmrb__bool.html" title="mruby Boolean ">mrb_bool</a> mrb_ro_data_p(const char *ptr)</code>.</li>
<li>Return <code>TRUE</code> if <code>ptr</code> is in read-only section, otherwise return <code>FALSE</code>.</li>
</ul>
<h2>Other configuration.</h2>
<p><code>MRB_UTF8_STRING</code></p><ul>
<li>Adds UTF-8 encoding support to character-oriented String instance methods.</li>
<li>If it isn't defined, they only support the US-ASCII encoding.</li>
</ul>
<p><code>MRB_FUNCALL_ARGC_MAX</code></p><ul>
<li>Default value is <code>16</code>.</li>
<li>Specifies 4th argument(<code>argc</code>) max value of <code>mrb_funcall</code>.</li>
<li>Raises <code>ArgumentError</code> when the <code>argc</code> argument is bigger then this value <code>mrb_funcall</code>.</li>
</ul>
<p><code>KHASH_DEFAULT_SIZE</code></p><ul>
<li>Default value is <code>32</code>.</li>
<li>Specifies default size of khash table bucket.</li>
<li>Used in <code>kh_init_ ## name</code> function.</li>
</ul>
<p><code>MRB_STR_BUF_MIN_SIZE</code></p><ul>
<li>Default value is <code>128</code>.</li>
<li>Specifies initial capacity of <code><a class="el" href="structRString.html">RString</a></code> created by <code>mrb_str_buf_new</code> function..</li>
</ul>
<p><code>MRB_METHOD_CACHE</code></p><ul>
<li>Improve performance for method dispatch.</li>
</ul>
<p><code>MRB_METHOD_CACHE_SIZE</code></p><ul>
<li>Default value is <code>128</code>.</li>
<li>Ignored if <code>MRB_METHOD_CACHE</code> is not defined.</li>
<li>Need to be the power of 2.</li>
</ul>
<p><code>MRB_METHOD_TABLE_INLINE</code></p><ul>
<li>Reduce the size of method table.</li>
<li>Requires LSB of function pointers to be zero.</li>
<li>For example, you might need to specify <code>--falign-functions=n</code> (where <code>n &gt; 1</code>) for GCC.</li>
</ul>
<p><code>MRB_ENABLE_ALL_SYMBOLS</code></p><ul>
<li>Make it available <code>Symbols.all_symbols</code> in <code>mrbgems/mruby-symbol-ext</code></li>
<li>Increase heap memory usage. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
